# Приложение для математических операций

Веб-приложение на Golang с использованием Gin и MongoDB для выполнения математических операций (умножение, деление, сложение, вычитание и возведение в квадрат) и сохранения результатов.

## Содержание

1. [Общее описание](#общее-описание)
2. [Технический стек](#технический-стек)
3. [Установка и запуск](#установка-и-запуск)
4. [Структура проекта](#структура-проекта)
5. [API документация](#api-документация)
6. [Структура базы данных](#структура-базы-данных)
7. [Пользовательская инструкция](#пользовательская-инструкция)
8. [Возможные проблемы и их решения](#возможные-проблемы-и-их-решения)

## Общее описание

Приложение предоставляет веб-интерфейс для выполнения математических операций (умножение, деление, сложение, вычитание и возведение в квадрат) над числами. Результаты операций сохраняются в базе данных MongoDB и отображаются в таблице с возможностью сортировки и фильтрации.

Основные возможности:
- Ввод двух чисел и выбор операции (умножение, деление, сложение, вычитание или возведение в квадрат)
- Сохранение результатов в MongoDB
- Система логирования всех операций с информацией о пользователе
- Просмотр истории результатов в таблице
- Сортировка результатов по любому столбцу (по возрастанию или убыванию)
- Фильтрация результатов по типу операции

## Технический стек

- **Язык программирования**: Go (Golang) 1.16+
- **Веб-фреймворк**: Gin
- **База данных**: MongoDB
- **Контейнеризация**: Docker и Docker Compose
- **Фронтенд**: HTML, CSS, JavaScript (без фреймворков)

## Установка и запуск

### Требования

- Go (версия 1.16+)
- Docker и Docker Compose
- Git (для клонирования репозитория)

### Шаги по установке

1. Клонируйте репозиторий:
   ```bash
   git clone https://github.com/yourusername/go_multiply_app.git
   cd go_multiply_app
   ```

2. Установите зависимости:
   ```bash
   go mod download
   ```

### Запуск с Docker

1. Запустите MongoDB и приложение с помощью Docker Compose:
   ```bash
   docker-compose up -d
   ```

2. Приложение будет доступно по адресу:
   ```
   http://localhost:8080
   ```

### Запуск без Docker

1. Запустите MongoDB:
   ```bash
   # Настройте MongoDB на порту 27017
   # Создайте пользователя admin с паролем password
   ```

2. Запустите приложение:
   ```bash
   go run main.go
   ```

3. Приложение будет доступно по адресу:
   ```
   http://localhost:8080
   ```

## Структура проекта

- `main.go` - основной файл приложения, содержит логику сервера и API эндпоинты
- `models/result.go` - модель данных для результатов операций
- `models/log.go` - модель данных для логирования операций
- `templates/index.html` - HTML шаблон пользовательского интерфейса
- `docker-compose.yml` - конфигурация Docker для запуска приложения и MongoDB
- `go.mod` и `go.sum` - файлы управления зависимостями Go

## API документация

### Эндпоинты

#### GET /

- **Описание**: Главная страница приложения с формой ввода и таблицей результатов
- **Параметры**: Нет
- **Ответ**: HTML страница
- **Пример запроса**:
  ```
  GET http://localhost:8080/
  ```

#### POST /multiply

- **Описание**: Выполняет операцию умножения двух чисел
- **Параметры формы**:
  - `number1` (число) - первое число
  - `number2` (число) - второе число
- **Ответ**: Перенаправление на главную страницу
- **Пример запроса**:
  ```
  POST http://localhost:8080/multiply
  Content-Type: application/x-www-form-urlencoded

  number1=5&number2=3
  ```

#### POST /divide

- **Описание**: Выполняет операцию деления двух чисел
- **Параметры формы**:
  - `number1` (число) - первое число (делимое)
  - `number2` (число) - второе число (делитель)
- **Ответ**: Перенаправление на главную страницу
- **Коды ошибок**:
  - `400 Bad Request` - при попытке деления на ноль
- **Пример запроса**:
  ```
  POST http://localhost:8080/divide
  Content-Type: application/x-www-form-urlencoded

  number1=10&number2=2
  ```

#### POST /add

- **Описание**: Выполняет операцию сложения двух чисел
- **Параметры формы**:
  - `number1` (число) - первое слагаемое
  - `number2` (число) - второе слагаемое
- **Ответ**: Перенаправление на главную страницу
- **Пример запроса**:
  ```
  POST http://localhost:8080/add
  Content-Type: application/x-www-form-urlencoded

  number1=5&number2=3
  ```

#### POST /subtract

- **Описание**: Выполняет операцию вычитания двух чисел
- **Параметры формы**:
  - `number1` (число) - уменьшаемое
  - `number2` (число) - вычитаемое
- **Ответ**: Перенаправление на главную страницу
- **Пример запроса**:
  ```
  POST http://localhost:8080/subtract
  Content-Type: application/x-www-form-urlencoded

  number1=10&number2=3
  ```

#### POST /square

- **Описание**: Выполняет операцию возведения числа в квадрат
- **Параметры формы**:
  - `number1` (число) - число для возведения в квадрат
- **Ответ**: Перенаправление на главную страницу
- **Пример запроса**:
  ```
  POST http://localhost:8080/square
  Content-Type: application/x-www-form-urlencoded

  number1=5
  ```

### Коды ошибок

- `400 Bad Request` - неверный формат чисел или деление на ноль
- `500 Internal Server Error` - ошибка при сохранении результата в базу данных или другие внутренние ошибки

## Структура базы данных

### База данных: multiply_app

### Коллекция: results

Схема документа:

| Поле      | Тип          | Описание                                   |
|-----------|--------------|-------------------------------------------|
| _id       | ObjectID     | Уникальный идентификатор (автогенерация)   |
| number1   | float64      | Первое число                               |
| number2   | float64      | Второе число                               |
| result    | float64      | Результат операции                         |
| operation | string       | Тип операции ("multiply", "divide", "add", "subtract", "square") |
| created_at| time.Time    | Время создания записи                      |

### Коллекция: logs

Схема документа:

| Поле      | Тип          | Описание                                   |
|-----------|--------------|-------------------------------------------|
| _id       | ObjectID     | Уникальный идентификатор (автогенерация)   |
| operation | string       | Тип операции                               |
| input     | string       | Входные данные (например, "5 + 3")         |
| result    | string       | Результат операции                         |
| user_ip   | string       | IP-адрес пользователя                      |
| timestamp | time.Time    | Время выполнения операции                  |

## Пользовательская инструкция

### Доступ к приложению

Откройте в браузере адрес `http://localhost:8080` после запуска приложения.

### Выполнение математических операций

1. В форме в верхней части страницы введите два числа в соответствующие поля.
   - Для операции возведения в квадрат используется только первое число.
2. Выберите операцию, нажав на одну из кнопок:
   - "Сложить" - сложение двух чисел
   - "Вычесть" - вычитание второго числа из первого
   - "Умножить" - умножение двух чисел
   - "Разделить" - деление первого числа на второе
   - "Квадрат" - возведение первого числа в квадрат
3. Результат операции будет сохранен в базе данных и отображен в таблице результатов.

### Работа с таблицей результатов

#### Просмотр истории операций

Таблица результатов отображается под формой ввода и содержит следующие столбцы:
- Первое число
- Второе число
- Результат
- Операция
- Дата

#### Сортировка результатов

1. Для сортировки результатов нажмите на заголовок соответствующего столбца.
2. Первое нажатие сортирует по возрастанию, второе - по убыванию.
3. Текущее направление сортировки отображается стрелкой рядом с заголовком столбца.

#### Фильтрация результатов

1. Используйте выпадающий список "Фильтр по операции" над таблицей.
2. Выберите один из вариантов:
   - "Все операции" - отображает все результаты
   - "Только сложение" - отображает только результаты сложения
   - "Только вычитание" - отображает только результаты вычитания
   - "Только умножение" - отображает только результаты умножения
   - "Только деление" - отображает только результаты деления
   - "Только возведение в квадрат" - отображает только результаты возведения в квадрат

### Возможные ошибки

- **Неверный формат чисел**: Убедитесь, что вводите корректные числовые значения.
- **Деление на ноль**: При попытке деления на ноль будет отображено сообщение об ошибке.
- **Проблемы с подключением к базе данных**: Если возникают ошибки при сохранении результатов, проверьте доступность MongoDB.

## Возможные проблемы и их решения

### Проблема: Приложение не запускается

**Решение**:
1. Проверьте, запущен ли контейнер MongoDB:
   ```bash
   docker ps
   ```
2. Проверьте логи приложения:
   ```bash
   docker-compose logs app
   ```

### Проблема: Ошибка подключения к MongoDB

**Решение**:
1. Проверьте доступность MongoDB:
   ```bash
   docker-compose logs mongodb
   ```
2. Убедитесь, что учетные данные для MongoDB в `main.go` соответствуют настройкам в `docker-compose.yml`.

### Проблема: Таблица результатов пуста

**Решение**:
1. Выполните несколько операций для создания записей.
2. Проверьте, что фильтр установлен на "Все операции".
3. Проверьте подключение к базе данных в логах приложения. 